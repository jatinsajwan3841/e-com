(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[8],{119:function(e,t,n){"use strict";var a=n(123),c=n(2);t.a=function(e){var t=e.title;return Object(c.jsx)(a.a,{children:Object(c.jsx)("title",{children:t})})}},125:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var a=n(5),c=n.n(a),r=n(12),s=function(e,t){return function(n,a){var c;n({type:"ADD_TO_CART",payload:{_id:e._id,name:e.name,price:e.price,image:e.image||(null===e||void 0===e||null===(c=e.images[0])||void 0===c?void 0:c.url),stock:e.stock,quantity:t}}),localStorage.setItem("cartItems",JSON.stringify(a().cart.cartItems))}},i=function(e){return function(t,n){t({type:"REMOVE_CART_ITEM",payload:e}),localStorage.setItem("cartItems",JSON.stringify(n().cart.cartItems))}},o=function(e){return function(){var t=Object(r.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n({type:"SAVE_SHIPPING_INFO",payload:e}),localStorage.setItem("shippingInfo",JSON.stringify(e));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}},152:function(e,t,n){},153:function(e,t,n){},161:function(e,t,n){},173:function(e,t,n){"use strict";n.r(t);var a=n(5),c=n.n(a),r=n(12),s=n(9),i=n(0),o=n.n(i),l=n(119),u=n(7),d=n(4),p=n(16),j=n(18),m=(n(152),n(3)),h=n(2),b=function(e){e.setStep;var t=Object(u.c)((function(e){return e.cart})),n=t.shippingInfo,a=t.cartItems,s=Object(u.c)((function(e){return e.user})).user,i=Object(d.f)(),b=Object(u.b)(),f=o.a.useRef(),O=a.reduce((function(e,t){return e+t.quantity*t.price}),0),x=O>1e3?0:50,v=.18*O,g=O+v+x,y="".concat(n.address,", ").concat(n.city,", ").concat(n.state,", ").concat(n.pinCode,", ").concat(n.country),S=function(){var e=Object(r.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/api/v1/init-txn",{uid:f.current,totalPrice:g},{headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,n=t.data,e.next=6,JSON.parse(n.response);case 6:n.response=e.sent,N(n.response);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(e){var t={root:"",flow:"DEFAULT",data:{orderId:f.current,token:e.body.txnToken,tokenType:"TXN_TOKEN",amount:g},merchant:{redirect:!1},handler:{notifyMerchant:function(e,t){console.log("notifyMerchant handler function called"),console.log("eventName => ",e),console.log("data => ",t)},transactionStatus:function(e){if(console.log("paymentStatus => ",e),"01"===e.RESPCODE){alert("Payment Successfull");var t={txn_id:e.TXNID,txnStatus:e.TXNDATE,txnDate:e.TXNDATE,gatewayName:e.GATEWAYNAME,txnMode:e.PAYMENTMODE};b(function(e){return function(){var t=Object(r.a)(c.a.mark((function t(n){var a,r,s,i,o,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n({type:"CREATE_ORDER_REQUEST"}),a={headers:{"Content-Type":"application/json"}},r=JSON.parse(sessionStorage.getItem("orderInfo")),(s=JSON.parse(localStorage.getItem("cartItems"))).forEach((function(e){e.product=e._id,delete e._id})),i=Object(m.a)({shippingInfo:JSON.parse(localStorage.getItem("shippingInfo")),orderItems:s,paymentInfo:e},r),t.next=9,j.a.post("/api/v1/order/new",i,a);case 9:o=t.sent,l=o.data,n({type:"CREATE_ORDER_SUCCESS",payload:l}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),n({type:"CREATE_ORDER_FAIL",payload:t.t0.response.data.message});case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}()}(t)),localStorage.removeItem("cartItems"),sessionStorage.removeItem("uid"),sessionStorage.removeItem("orderInfo"),i("/"),window.location.reload()}else"400"===e.RESPCODE?(alert("Payment Pending"),window.location.reload()):(alert(e.RESPMSG),window.location.reload())}}};window.Paytm&&window.Paytm.CheckoutJS&&window.Paytm.CheckoutJS.init(t).then((function(){window.Paytm.CheckoutJS.invoke()})).catch((function(e){console.log("error => ",e)}))};return o.a.useEffect((function(){sessionStorage.getItem("uid")?f.current=sessionStorage.getItem("uid"):(f.current=Date.now().toString(36)+Math.random().toString(36).substr(2),sessionStorage.setItem("uid",f.current))}),[]),Object(h.jsxs)("div",{className:"confirm-container",children:[Object(h.jsx)(l.a,{title:"Confirm Order"}),Object(h.jsxs)("div",{className:"left",children:[Object(h.jsx)("span",{className:"title",children:"Shipping Info"}),Object(h.jsxs)("div",{className:"shipping-info-box",children:[Object(h.jsx)("div",{className:"shipping-info-item",children:Object(h.jsxs)("p",{children:["Name: "," ",Object(h.jsx)("span",{children:s.name})]})}),Object(h.jsx)("div",{className:"shipping-info-item",children:Object(h.jsxs)("p",{children:["Phone: "," ",Object(h.jsx)("span",{children:n.phoneNumber})]})}),Object(h.jsx)("div",{className:"shipping-info-item",children:Object(h.jsxs)("p",{children:["Address: "," ",Object(h.jsx)("span",{children:y})]})})]}),Object(h.jsxs)("div",{className:"cart-items-container",children:[Object(h.jsx)("div",{className:"title",children:"Your Cart Items:"}),a&&a.map((function(e,t){return Object(h.jsx)(p.b,{to:"/product/".concat(e._id),children:Object(h.jsxs)("div",{className:"cart-items",children:[Object(h.jsx)("img",{src:e.image,alt:"Product"}),e.name,Object(h.jsxs)("span",{children:[e.quantity," X \u20b9",e.price," ="," ",Object(h.jsxs)("b",{children:["\u20b9",e.price*e.quantity]})]})]})},t)}))]})]}),Object(h.jsxs)("div",{className:"right",children:[Object(h.jsx)("div",{className:"title",children:" Order Summary"}),Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"order-summary",children:[Object(h.jsx)("p",{children:"Subtotal:"}),Object(h.jsxs)("span",{children:["\u20b9",O]})]}),Object(h.jsxs)("div",{className:"order-summary",children:[Object(h.jsx)("p",{children:"Shipping Charges:"}),Object(h.jsxs)("span",{children:["\u20b9",x]})]}),Object(h.jsxs)("div",{className:"order-summary",children:[Object(h.jsx)("p",{children:"GST:"}),Object(h.jsxs)("span",{children:["\u20b9",v]})]})]}),Object(h.jsxs)("div",{className:"order-summary total",children:[Object(h.jsx)("p",{children:Object(h.jsx)("b",{children:"Total:"})}),Object(h.jsxs)("span",{children:["\u20b9",g]})]}),Object(h.jsx)("button",{type:"button",className:"proceed",onClick:function(){var e={subtotal:O,shippingCharges:x,tax:v,totalPrice:g};sessionStorage.setItem("orderInfo",JSON.stringify(e)),S()},children:"Proceed to payment"})]})]})},f=[{label:"Please Enter Your Address",type:"text",name:"address",placeholder:"Address"},{label:"Please Enter Your City",type:"text",name:"city",placeholder:"City"},{label:"Please Enter Your Pin Code",type:"tel",name:"pinCode",placeholder:"Pin Code",minLength:"6",maxLength:"6",pattern:"[0-9]{6}"},{label:"Please Enter Your Phone Number",type:"tel",name:"phoneNumber",placeholder:"Phone Number",minLength:"10",maxLength:"10",pattern:"[0-9]{10}"}],O=(n(153),n(125)),x=n(154),v=function(e){var t=e.setStep,n=Object(u.c)((function(e){return e.cart})),a=n.shippingInfo,c=o.a.useState(a.state),r=Object(s.a)(c,2),i=r[0],l=r[1],d=o.a.useState(a.country),p=Object(s.a)(d,2),j=p[0],m=p[1],b=o.a.useRef(),v=Object(u.b)();return o.a.useEffect((function(){a.address&&f.forEach((function(e,t){b.current[t].value=a[e.name]}))}),[a]),Object(h.jsxs)("form",{className:"shipping-container",onSubmit:function(e){e.preventDefault();var n={};f.forEach((function(t){var a=t.name,c=e.target[a].value;n[a]=c})),n.country=j,n.state=i,v(Object(O.c)(n)),t(1)},ref:b,children:[Object(h.jsx)("div",{className:"head",children:"Shipping Details"}),f.map((function(e,t){return Object(h.jsxs)("div",{className:"inp-content",children:[Object(h.jsx)("label",{htmlFor:e.name,className:"label",children:e.label}),Object(h.jsx)("input",{type:e.type,name:e.name,placeholder:" ",minLength:e.minLength||"3",maxLength:e.maxLength||"100",pattern:e.pattern,required:!0}),Object(h.jsx)("hr",{className:"border-bottom"}),Object(h.jsx)("span",{className:"placeholder",children:e.placeholder})]},t)})),Object(h.jsxs)("div",{className:"inp-content",children:[Object(h.jsx)("span",{className:"placeholder",children:"Please select your country"}),Object(h.jsxs)("select",{name:"country",className:"select",required:!0,value:j,onChange:function(e){return m(e.target.value)},children:[Object(h.jsx)("option",{value:"",children:"Country"}),x.Country&&x.Country.getAllCountries().map((function(e){return Object(h.jsx)("option",{value:e.isoCode,children:e.name},e.isoCode)}))]})]}),j&&Object(h.jsxs)("div",{className:"inp-content",children:[Object(h.jsx)("span",{className:"placeholder",children:"Please select your state"}),Object(h.jsxs)("select",{className:"inp-content select",required:!0,value:i,onChange:function(e){return l(e.target.value)},children:[Object(h.jsx)("option",{value:"",children:"State"}),x.State&&x.State.getStatesOfCountry(j).map((function(e){return Object(h.jsx)("option",{value:e.isoCode,children:e.name},e.isoCode)}))]})]}),Object(h.jsx)("div",{className:"cont-btns",children:Object(h.jsx)("input",{type:"submit",className:"continue",value:"Continue"})})]})};n(161),t.default=function(){var e=o.a.useState(0),t=Object(s.a)(e,2),n=t[0],a=t[1];return o.a.useEffect((function(){var e=function(){var e=Object(r.a)(c.a.mark((function e(){var t,n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("/api/v1/paytm-MID");case 2:t=e.sent,n=t.data,a="https://securegw-stage.paytm.in/merchantpgpui/checkoutjs/merchants/".concat(n.MID,".js"),(r=document.createElement("script")).src=a,r.async=!0,r.type="application/javascript",document.body.appendChild(r);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(h.jsxs)("div",{className:"check-out",children:[0===n&&Object(h.jsx)(v,{setStep:a}),1===n&&Object(h.jsx)(b,{setStep:a}),2===n&&Object(h.jsx)(v,{setStep:a}),Object(h.jsx)("div",{className:"cont-btns",children:0!==n&&Object(h.jsx)("button",{className:"continue",type:"button",onClick:function(){return a((function(e){return e-1}))},children:"Previous"})})]})}}}]);
//# sourceMappingURL=8.65ec74ef.chunk.js.map